<div id="anim-gazapo" class="anim-container hidden">
  <div class="code-line">INPUT: "El perro <span id="glitch-word" class="word">vuela</span> alto."</div>
  <div id="scanner-line" class="scanner"></div>
  <div id="alert-box" class="alert hidden">
      ⚠️ GAZAPO DETECTADO<br>
      <span class="correction">Probabilidad: 0.001%</span>
  </div>
</div>

<script>
    const container = document.getElementById('anim-gazapo');
    const word = document.getElementById('glitch-word');
    const scanner = document.getElementById('scanner-line');
    const alertBox = document.getElementById('alert-box');

    window.addEventListener('kidia:play-animation', (e) => {
        if ((e as CustomEvent).detail.name === 'gazapo') {
            play();
        }
    });

    function play() {
        if(!container) return;
        container.classList.remove('hidden');
        
        // Reset
        word.classList.remove('glitch');
        scanner.classList.remove('scan-anim');
        alertBox.classList.add('hidden');
        
        // 1. Scan
        scanner.classList.add('scan-anim');
        
        // 2. Glitch match
        setTimeout(() => {
            word.classList.add('glitch');
        }, 1500);

        // 3. Alert
        setTimeout(() => {
            alertBox.classList.remove('hidden');
            alertBox.classList.add('shake');
        }, 2000);
        
        setTimeout(() => {
            container.classList.add('hidden');
        }, 6000);
    }
</script>

<style>
    .anim-container {
        position: fixed;
        top: 20%;
        left: 50%;
        transform: translate(-50%, 0);
        background: #000;
        border: 2px solid #333;
        padding: 2rem;
        border-radius: 0.5rem;
        font-family: monospace;
        color: #0f0;
        z-index: 2000;
        width: 350px;
        overflow: hidden;
    }
    .hidden { display: none !important; }
    
    .code-line { font-size: 1.2rem; position: relative; z-index: 2; }
    
    .scanner {
        position: absolute;
        top: 0;
        left: -100%;
        width: 20px;
        height: 100%;
        background: rgba(34, 197, 94, 0.5);
        box-shadow: 0 0 10px #22c55e;
        z-index: 1;
    }
    
    .scan-anim {
        animation: scan 2s linear forwards;
    }
    
    .word.glitch {
        color: red;
        font-weight: bold;
        text-shadow: 2px 0 blue, -2px 0 red;
    }
    
    .alert {
        margin-top: 1.5rem;
        background: #ef4444;
        color: white;
        padding: 0.5rem;
        text-align: center;
        border: 2px solid white;
    }
    
    .shake {
        animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
    }

    @keyframes scan {
        0% { left: -20%; }
        100% { left: 120%; }
    }
    
    @keyframes shake {
        10%, 90% { transform: translate3d(-1px, 0, 0); }
        20%, 80% { transform: translate3d(2px, 0, 0); }
        30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
        40%, 60% { transform: translate3d(4px, 0, 0); }
    }
</style>
